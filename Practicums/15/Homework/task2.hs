main :: IO()
main = do
    print $ (sumExpr (2+) [0, 1, 2, 3]) 2 == 80
    print $ (sumExpr (*0.8) [0, 1, 2, 3, 4, 5]) 10 == 4345680.0

sumExpr :: (Num a) => (a -> a) -> [a] -> (a -> a)
sumExpr f ys = (\x -> sum [ y * f (x^i) | (y, i) <- zip ys [1 ..]])

{-
sumExpr (2+) [0, 1, 2, 3] $ 2
 > (\2 -> [ y * ((2^i) + 2) | (y, i) <- [(0, 1), (1, 2), (2, 3), (3, 4)])
 > [ y * ((2^i) + 2) | (y, i) <- [(0, 1), (1, 2), (2, 3), (3, 4)]
 > [ 0 * 4 | (0, 1) <- [(1, 2), (2, 3), (3, 4)] => [0]
 > [ 1 * (4 + 2) | (1, 2) <- [(2, 3), (3, 4)] => [0, 6]
 > [ 2 * 10 | (2, 3) <- [(3, 4)] => [0, 6, 20]
 > [ 3 * 18 | (3, 4) <- [] => [0, 6, 20, 54]
-}